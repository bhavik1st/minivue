<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiniVue Demo</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      color: #42b883;
      border-bottom: 2px solid #35495e;
      padding-bottom: 10px;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input, textarea, select {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    button {
      background-color: #42b883;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 8px;
      margin-bottom: 8px;
    }
    button:hover {
      background-color: #3ba776;
    }
    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    .hidden {
      display: none;
    }
    .mouse-area {
      height: 100px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .mouse-coords {
      font-family: monospace;
    }
    .event-log {
      background-color: #f8f8f8;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      margin-top: 10px;
    }
    .log-entry {
      padding: 3px 0;
      border-bottom: 1px solid #eee;
    }
    .tag {
      display: inline-block;
      background-color: #e0e0e0;
      color: #333;
      padding: 2px 8px;
      border-radius: 12px;
      margin-right: 5px;
      margin-bottom: 5px;
      font-size: 0.9em;
    }
    .dynamic-border {
      border: 2px solid #42b883;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 4px;
    }
    [disabled] {
      opacity: 0.6;
      cursor: not-allowed;
    }
    .todo-item {
      display: flex;
      align-items: center;
      margin: 8px 0;
      padding: 8px;
      border-radius: 4px;
      background-color: #f5f5f5;
    }
    .todo-item span {
      flex: 1;
      margin: 0 10px;
    }
    .todo-item .completed {
      text-decoration: line-through;
      color: #888;
    }
    .btn-small {
      font-size: 12px;
      padding: 3px 8px;
    }
    .btn-danger {
      background-color: #dc3545;
      color: white;
      border: none;
    }
    .todo-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <h1>MiniVue Demo</h1>
  
  <div id="app">
    <div class="card">
      <h2>Data Binding Demo</h2>
      
      <label for="name">Name:</label>
      <input type="text" id="name" m-model="name">
      
      <div>
        <p>Hello, <strong>{{ name }}</strong>!</p>
      </div>
    </div>
    
    <div class="card">
      <h2>Attribute Binding</h2>
      
      <h3>Input Placeholders</h3>
      <input type="text" m-bind:placeholder="inputPlaceholder">
      <input type="text" m-bind:placeholder="inputPlaceholder + ' (shorthand)'">
      
      <div style="margin-top: 15px;">
        <label for="placeholderEdit">Change placeholder:</label>
        <input type="text" id="placeholderEdit" m-model="inputPlaceholder">
      </div>
      
      <h3 style="margin-top: 20px;">Dynamic Attributes</h3>
      
      <div>
        <label>
          <input type="checkbox" m-model="isDisabled"> Disable buttons
        </label>
        
        <div style="margin-top: 10px;">
          <button m-bind:disabled="isDisabled">Regular Button (m-bind)</button>
          <button m-bind:disabled="isDisabled">Shorthand Button</button>
        </div>
      </div>
      
      <h3 style="margin-top: 20px;">Style Binding</h3>
      
      <div>
        <label for="borderColor">Border Color:</label>
        <select id="borderColor" m-model="borderColor" @change="updateBorderStyle">
          <option value="#42b883">Green (Default)</option>
          <option value="red">Red</option>
          <option value="blue">Blue</option>
          <option value="orange">Orange</option>
        </select>
        
        <div class="dynamic-border" style="border: 2px solid" m-bind:style="'border-color: ' + borderColor">
          <p>This box has a dynamically bound border color.</p>
        </div>
      </div>
      
      <h3 style="margin-top: 20px;">Link with Dynamic Href</h3>
      
      <div>
        <label for="linkUrl">URL:</label>
        <input type="text" id="linkUrl" m-model="linkUrl">
        
        <div style="margin-top: 10px;">
          <a m-bind:href="linkUrl" target="_blank">Visit dynamic link</a>
        </div>
      </div>
      
      <h3 style="margin-top: 20px;">Computed Attributes</h3>
      
      <div>
        <label for="inputValue">Enter a number:</label>
        <input type="number" id="inputValue" m-model="inputValue" min="0" max="100">
        
        <progress m-bind:value="inputValue" m-bind:max="100"></progress>
        <p>Progress: {{ inputValue }}%</p>
      </div>
    </div>
    
    <div class="card">
      <h2>Conditional Rendering</h2>
      
      <label>
        <input type="checkbox" m-model="showMessage"> Toggle message visibility
      </label>
      
      <div m-if="showMessage">
        <p>This message will appear and disappear based on the checkbox.</p>
      </div>
    </div>
    
    <div class="card">
      <h2>Basic Event Handling</h2>
      
      <p>Counter: {{ counter }}</p>
      
      <div>
        <button m-on:click="incrementCounter">Increment</button>
        <button @click="decrementCounter">Decrement</button>
        <button @click="resetCounter">Reset</button>
      </div>
    </div>
    
    <div class="card">
      <h2>Advanced Event Handling</h2>
      
      <div>
        <h3>Event with Parameters</h3>
        <p>Value: {{ value }}</p>
        <div>
          <button @click="updateValue(5)">Add 5</button>
          <button @click="updateValue(10)">Add 10</button>
          <button @click="updateValue(20)">Add 20</button>
          <button @click="updateValue(-value)">Reset</button>
        </div>
      </div>
      
      <div style="margin-top: 20px">
        <h3>Mouse Events</h3>
        <div class="mouse-area" 
             @mousemove="trackMouse($event)" 
             @mouseenter="logEvent('mouseenter', $event)"
             @mouseleave="logEvent('mouseleave', $event)">
          <span class="mouse-coords">X: {{ mouseX }}, Y: {{ mouseY }}</span>
        </div>
      </div>
      
      <div style="margin-top: 20px">
        <h3>Form Events</h3>
        <select @change="handleSelectChange($event)">
          <option value="">-- Select an option --</option>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
        </select>
        <p m-if="selectedOption">You selected: {{ selectedOption }}</p>
      </div>
      
      <div style="margin-top: 20px">
        <h3>Keyboard Events</h3>
        <input type="text" 
               placeholder="Type something and press Enter"
               @keydown="handleKeydown($event)">
        <p>Last key pressed: {{ lastKey }}</p>
      </div>
      
      <div style="margin-top: 20px">
        <h3>Event Log</h3>
        <div class="event-log">
          <div class="log-entry" m-if="eventLogs.length === 0">No events logged yet.</div>
          <div class="log-entry" m-for="log in eventLogs">{{ log }}</div>
        </div>
      </div>
    </div>
    
    <div class="card">
      <h2>Reactive Properties</h2>
      
      <p>Character count: {{ charCount }}</p>
      <textarea m-model="message" placeholder="Type something..."></textarea>
      <button @click="clearMessage">Clear</button>
    </div>
  </div>

  <hr>
  <div class="container">
    <h2>m-for Directive Example</h2>
    <div id="for-app">
      <h3>Todo List</h3>
      <div class="form-group">
        <input 
          type="text" 
          m-model="newTodo" 
          placeholder="Add a new task"
          class="form-control">
        <button @click="addTodo" class="btn btn-primary">Add</button>
      </div>
      
      <div class="m-for-container">
        <div m-for="todo in todos" class="todo-item">
          <input type="checkbox" m-model="todo.completed">
          <span :class="{'completed': todo.completed}">{{ todo.text }}</span>
          <button @click="removeTodo(todo)" class="btn btn-small btn-danger">Ã—</button>
        </div>
      </div>
      
      <div class="todo-info">
        <!-- TODO: Use computed property -->
        <p>Remaining tasks: {{ todos.length }}</p>
        <button @click="clearCompleted" class="btn btn-small">Clear Completed</button>
      </div>
    </div>
  </div>

  <script src="minivue.js"></script>
  <script>
    const app = new MiniVue({
      el: '#app',
      debug: true,
      data: {
        name: 'World',
        showMessage: true,
        message: '',
        charCount: 0,
        counter: 0,
        value: 0,
        mouseX: 0,
        mouseY: 0,
        selectedOption: '',
        lastKey: '',
        eventLogs: [],
        // New properties for attribute binding demo
        inputPlaceholder: 'Enter some text',
        isDisabled: false,
        borderColor: '#42b883',
        borderStyle: { 'border-color': '#42b883' },
        linkUrl: 'https://github.com',
        inputValue: 50
      },
      methods: {
        // Basic counter methods
        incrementCounter() {
          this.counter++;
        },
        decrementCounter() {
          if (this.counter > 0) {
            this.counter--;
          }
        },
        resetCounter() {
          this.counter = 0;
        },
        
        // Advanced event methods
        updateValue(amount) {
          this.value += amount;
        },
        trackMouse(event) {
          this.mouseX = event.offsetX;
          this.mouseY = event.offsetY;
        },
        handleSelectChange(event) {
          this.selectedOption = event.target.value;
          this.logEvent('change', `Selected: ${this.selectedOption}`);
        },
        handleKeydown(event) {
          this.lastKey = event.key;
          if (event.key === 'Enter') {
            this.logEvent('keydown', `Enter key pressed ${this.lastKey}`);
          }
        },
        logEvent(type, eventOrMessage) {
          const timestamp = new Date().toLocaleTimeString();
          const message = typeof eventOrMessage === 'string' 
            ? eventOrMessage 
            : `${type} event at (${eventOrMessage.clientX}, ${eventOrMessage.clientY})`;
            
          this.eventLogs.unshift(`[${timestamp}] ${message}`);
          
          // Keep log size manageable
          if (this.eventLogs.length > 10) {
            this.eventLogs.pop();
          }
        },
        
        // Utility methods
        clearMessage() {
          this.message = '';
          this.charCount = 0;
        },
        updateBorderStyle() {
          // Force a re-render by creating a new style object
          this.borderColor = this.borderColor;
          // Also update DOM directly to ensure it works
          document.querySelector('.dynamic-border').style.borderColor = this.borderColor;
        }
      }
    });
    
    // Watch for changes on message to update charCount
    setInterval(() => {
      app.charCount = app.message.length;
    }, 100);

    // Initialize the todos example
    var todoApp = new MiniVue({
      el: '#for-app',
      data: {
        todos: [
          { id: 1, text: 'Learn MiniVue', completed: false },
          { id: 2, text: 'Build something awesome', completed: false },
          { id: 3, text: 'Share with the world', completed: false }
        ],
        newTodo: ''
      },
      // computed: {
      //   remaining() {
      //    //return this.todos.filter(todo => !todo.completed).length;
      //    return 0;
      //   }
      // },
      methods: {
        remaining() {
          return this.todos.length;
        },
        addTodo() {
          if (!this.newTodo.trim()) return;
          this.todos.push({
            id: Date.now(),
            text: this.newTodo,
            completed: false
          });
          this.newTodo = '';
        },
        removeTodo(todo) {
          const index = this.todos.indexOf(todo);
          if (index !== -1) {
            this.todos.splice(index, 1);
          }
        },
        clearCompleted() {
          this.todos = this.todos.filter(todo => !todo.completed);
        }
      }
    });
  </script>
</body>
</html> 